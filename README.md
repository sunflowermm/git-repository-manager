# 🌻 向日葵Git仓库管理 v2.5 (Electron版)

基于 Electron 的现代化 Git 仓库管理工具，提供简洁直观的图形界面，支持多平台 Git 仓库的统一管理。

## ✨ 功能特性

### 核心功能
- ✅ **多平台支持**：GitHub、Gitee、GitCode、GitLab 等
- ✅ **多种认证方式**：SSH 密钥、HTTPS Token/密码
- ✅ **一键提交**：自动添加变更摘要（文件数、变更类型、行数统计）
- ✅ **提交并推送/同步**：支持一键提交并推送到远程，或同步到多个仓库
- ✅ **批量操作**：批量提交、推送、拉取多个仓库
- ✅ **主从仓库同步**：配置主从关系，一键同步到多个仓库
- ✅ **分支管理**：创建、切换分支，查看提交日志和文件差异
- ✅ **仓库克隆**：支持 HTTPS、SSH 及代理 URL
- ✅ **文件变更追踪**：实时显示仓库文件变更状态
- ✅ **操作日志**：详细的操作日志记录
- ✅ **主题切换**：支持浅色/深色主题

### 高级特性
- 🔐 **SSH 密钥自动检测**：自动识别 `~/.ssh` 目录下的默认密钥
- 🌐 **GitHub 代理支持**：支持 gh-proxy.com 等代理服务，加速访问
- 📦 **智能同步**：同远程自动 pull，不同远程则复制文件并推送
- 🎨 **现代化 UI**：流畅的动画效果，响应式设计

## 🚀 快速开始

### 系统要求

- **操作系统**：Windows 7+ / macOS 10.10+ / Linux
- **Node.js**：v14.0.0 或更高版本（开发环境）
- **Git**：已安装并配置 Git（必需）

### 安装依赖

**推荐方式（使用国内镜像）：**

项目已配置使用国内镜像源，直接安装：

```bash
npm install
```

**如果遇到安装错误：**

1. **使用清理脚本（Windows）：**
   ```bash
   # 双击运行 清理安装.bat
   ```

2. **手动清理后重新安装：**
   ```bash
   # 删除 node_modules 和 package-lock.json
   rm -rf node_modules package-lock.json
   # 重新安装
   npm install
   ```

3. **查看详细解决方案：**
   - 查看 `install.md` 获取详细安装指南
   - 检查网络连接和 npm 镜像配置

### 运行开发版本

```bash
npm run dev
# 或
npm start
```

### 打包应用

```bash
# Windows 64位
npm run build:win64

# Windows 32位
npm run build:win32

# Windows 自动检测架构
npm run build:win

# 所有平台
npm run build
```

打包后的文件在 `dist` 目录中。

## 📖 使用说明

### 1. 添加仓库

1. 点击工具栏的 **「添加仓库」** 按钮
2. 选择包含 `.git` 目录的 Git 仓库文件夹
3. 仓库会自动添加到左侧列表

**提示**：仓库路径会保存到本地配置，下次启动自动加载。

### 2. 配置平台认证

在使用推送、拉取等功能前，需要配置平台认证信息：

1. 点击工具栏的 **「平台配置」** 按钮
2. 选择对应的平台标签（GitHub、Gitee 等）
3. 配置认证方式：

   **方式一：SSH 密钥（推荐）**
   - 选择「SSH密钥」认证方式
   - 点击「浏览」选择私钥文件（如 `id_ed25519`、`id_rsa`）
   - 如果未选择，系统会自动检测 `~/.ssh` 目录下的默认密钥

   **方式二：账号密码/Token**
   - 选择「账号密码/Token」认证方式
   - 填写用户名和 Token（GitHub 使用 Personal Access Token）
   - 填写邮箱（用于 Git 提交）

4. **GitHub 代理配置（可选）**：
   - 勾选「使用代理」
   - 选择预设代理或自定义代理地址
   - 推荐代理：`https://ghproxy.net/`、`https://gh-proxy.com/`

5. 点击「确定」保存配置

### 3. 配置同步关系（可选）

如果需要将主仓库的变更同步到多个从仓库：

1. 点击工具栏的 **「同步配置」** 按钮
2. 选择主仓库
3. 勾选需要同步的从仓库（可多选）
4. 点击「保存同步组」

**同步机制**：
- 如果主从仓库使用相同的远程 URL，会自动执行 `git pull`
- 如果远程 URL 不同，会复制文件（忽略 `.git`、`node_modules` 等）并推送到从仓库

### 4. 基本操作

#### 提交变更

1. 在左侧列表选择仓库
2. 在「快速提交」区域输入提交信息（或使用默认信息）
3. 点击 **「一键提交」** 按钮

**提示**：提交信息会自动追加变更摘要，如 `[2 修改, 1 新增, +15 -3 行]`

#### 提交并推送

1. 选择仓库并输入提交信息
2. 点击 **「提交并推送」** 按钮
3. 系统会自动提交并推送到远程仓库

#### 提交并同步

1. 选择已配置为主仓库的仓库
2. 输入提交信息
3. 点击 **「提交并同步」** 按钮
4. 系统会提交主仓库，并同步到所有从仓库

#### 拉取/推送

- **拉取**：点击 **「⬇️ 拉取」** 按钮从远程拉取最新变更
- **推送**：点击 **「⬆️ 推送」** 按钮推送本地提交到远程

#### 分支操作

- **创建分支**：点击 **「🌿 创建分支」**，输入分支名称
- **切换分支**：点击 **「🔀 切换分支」**，选择要切换的分支
- **查看日志**：点击 **「📜 查看日志」** 查看提交历史
- **查看差异**：点击 **「🔍 查看差异」** 查看文件变更差异

#### 暂存操作

- **暂存变更**：点击 **「📦 暂存」** 将当前变更暂存
- **恢复暂存**：点击 **「📤 恢复暂存」** 恢复之前暂存的变更

### 5. 批量操作

1. 点击工具栏的 **「批量操作」** 按钮
2. 选择操作类型（批量提交/推送/拉取）
3. 勾选需要操作的仓库
4. 点击「确定」执行批量操作

**提示**：批量提交会自动使用时间戳作为提交信息。

### 6. 克隆仓库

1. 点击工具栏的 **「克隆仓库」** 按钮
2. 选择平台
3. 输入仓库 URL（支持 HTTPS、SSH 及代理 URL）
4. 选择克隆目标目录
5. 可选：设置本地文件夹名称
6. 点击「确定」开始克隆

克隆成功后，仓库会自动添加到列表。

## ⚙️ 配置说明

### 配置文件位置

- **Windows**：`%APPDATA%\git-manager-electron\config.json`
- **macOS**：`~/Library/Application Support/git-manager-electron/config.json`
- **Linux**：`~/.config/git-manager-electron/config.json`

### 配置内容

```json
{
  "repo_paths": ["仓库路径1", "仓库路径2"],
  "platform_configs": {
    "GitHub": {
      "auth_type": "ssh",
      "ssh_key_path": "C:\\Users\\username\\.ssh\\id_ed25519",
      "username": "your-username",
      "email": "your@email.com",
      "use_proxy": true,
      "proxy_url": "https://ghproxy.net/"
    }
  },
  "sync_config": {
    "sync_groups": {
      "group_1234567890": {
        "main": "主仓库名",
        "subordinates": ["从仓库1", "从仓库2"]
      }
    },
    "repo_to_group": {
      "主仓库名": "group_1234567890",
      "从仓库1": "group_1234567890",
      "从仓库2": "group_1234567890"
    }
  },
  "theme": "light"
}
```

## ⚠️ 注意事项

### SSH 密钥配置

- **必须选择私钥文件**（如 `id_ed25519`、`id_rsa`），不要选择公钥文件（`.pub`）
- 如果未选择密钥路径，系统会自动检测 `~/.ssh` 目录下的默认密钥
- 确保私钥文件有正确的权限（Linux/macOS：`chmod 600 ~/.ssh/id_ed25519`）

### Git 配置

- 确保 Git 已正确安装并配置
- 首次使用建议配置全局 Git 用户信息：
  ```bash
  git config --global user.name "Your Name"
  git config --global user.email "your@email.com"
  ```

### 代理配置

- GitHub 代理仅在使用 HTTPS 方式时生效
- 推荐使用 SSH 方式，无需配置代理
- 代理 URL 格式：`https://ghproxy.net/`（注意末尾斜杠）

### 同步功能

- 同步会忽略以下目录/文件：`.git`、`node_modules`、`__pycache__`、`.venv`、`dist`、`build` 等
- 同步前建议先提交主仓库的变更
- 如果主从仓库使用相同远程，同步会直接执行 `git pull`，速度更快

## 🔧 故障排除

### 问题：无法添加仓库

**可能原因**：
- 选择的目录不是 Git 仓库（没有 `.git` 目录）
- 目录权限不足

**解决方案**：
- 确保选择的是包含 `.git` 目录的文件夹
- 检查目录权限

### 问题：推送/拉取失败

**可能原因**：
- 未配置平台认证信息
- SSH 密钥路径错误或权限不足
- Token 过期或无效
- 网络连接问题

**解决方案**：
1. 检查「平台配置」中的认证信息是否正确
2. 验证 SSH 密钥是否有效：`ssh -T git@github.com`
3. 检查 Token 是否过期（GitHub Token 需要相应权限）
4. 如果使用代理，检查代理地址是否正确

### 问题：克隆失败

**可能原因**：
- URL 格式错误
- 认证信息未配置
- 目标目录已存在同名文件夹
- 网络连接问题

**解决方案**：
1. 检查 URL 格式是否正确
2. 确保已配置对应平台的认证信息
3. 选择不存在的目录或使用不同的文件夹名称
4. 如果使用代理，确保代理地址正确

### 问题：同步失败

**可能原因**：
- 从仓库未在列表中
- 从仓库路径不存在
- 认证信息未配置

**解决方案**：
1. 确保所有从仓库都已添加到列表
2. 检查从仓库路径是否存在
3. 确保主从仓库的平台配置都已正确设置

### 问题：应用无法启动

**可能原因**：
- Node.js 版本过低
- 依赖未正确安装
- 端口被占用

**解决方案**：
1. 检查 Node.js 版本：`node --version`（需要 v14+）
2. 重新安装依赖：删除 `node_modules` 和 `package-lock.json` 后重新 `npm install`
3. 检查是否有其他 Electron 应用在运行

## 📝 更新日志

### v2.5.0
- ✨ 新增通知系统，替换原有的 alert 弹窗
- 🎨 优化 UI 动画效果和响应式设计
- 🔧 优化代码结构，提取重复逻辑
- 🐛 修复多个已知问题
- 📚 完善文档和使用说明

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

---

**提示**：首次使用请先配置平台认证信息，推荐使用 SSH 密钥方式，更安全且无需配置代理。
